---
import BaseLayout from './BaseLayout.astro'
import Footer from '../components/Footer.astro'

export interface Props {
	title: string
	year: string
	position: string
	logo?: string
	logoOpen?: string
	workUrl?: string
	color: string
	description: string
	details?: string[]
}

const { title, year, position, logo, logoOpen, workUrl, color, description, details } = Astro.props
---

<BaseLayout title={title} pageColor={color} class={`${title.toLowerCase().replace(/\s+/g, '-')}-wrap`}>
	<div class="work-background"></div>

	<main>
		<div class="work-header-wrap">
			<header class="work-header xyz-in" xyz="fade down duration-5 ease-out-back">
				<div class="work-header-top">
					<div class="work-title-wrap xyz-in" xyz="fade left delay-4 ease-out-back">
						{
							logoOpen ? (
								<img class="work-logo" src={`/assets/logos/${logoOpen}`} alt={`${title} Logo`} />
							) : logo ? (
								<img class="work-logo" src={`/assets/logos/${logo}`} alt={`${title} Logo`} />
							) : (
								<h1 class="work-title">{title}</h1>
							)
						}
					</div>
					{
						workUrl && (
							<a href={workUrl} class="work-link button--themed" target="_blank">
								<span class="button__text">Visit</span>
							</a>
						)
					}
				</div>
				<div class="work-header-bottom" xyz="fade narrow stagger delay-8 origin-left">
					<div class="work-detail xyz-in">
						<span class="xyz-nested" xyz="fade down-100% duration-8 delay-10">{position} &ndash; {year}</span>
					</div>
					{
						details &&
							details.map((detail) => (
								<div class="work-detail xyz-in">
									<span class="xyz-nested" xyz="fade down-100% duration-8 delay-10">
										{detail}
									</span>
								</div>
							))
					}
				</div>
			</header>
		</div>

		<div class="grab-copy-wrap">
			<p class="grab-copy" set:html={description} />
		</div>

		<slot />
	</main>

	<Footer />

	<style define:vars={{ pageColor: color }}>
		:root {
			--page-color: var(--pageColor);
		}
	</style>
</BaseLayout>

<script>
	import PhotoSwipeLightbox from 'photoswipe/lightbox'
	import 'photoswipe/style.css'

	const lightbox = new PhotoSwipeLightbox({
		gallery: '#photoswipe-gallery',
		children: 'a',
		pswpModule: () => import('photoswipe'),
		zoom: false,
		counter: false,
		padding: { top: 24, bottom: 24, left: 24, right: 24 },
	})

	lightbox.init()
</script>
